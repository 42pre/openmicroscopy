<icegrid>

<!--
    OMERO Grid Application Descriptor
    Copyright 2008 Glencoe Software, Inc.  All Rights Reserved.
    Use is subject to license terms supplied in LICENSE.txt
-->

  <application name="OMERO" import-default-templates="true">

    <replica-group id="BlitzAdapters">
      <load-balancing type="adaptive" load-sample="5" n-replicas="2"/>
      <object identity="BlitzVerifier" type="::Glacier2::PermissionVerifier"/>
      <object identity="BlitzManager" type="::Glacier2::SessionManager"/>
    </replica-group>

    <replica-group id="ProcessorAdapters">
      <!--load-balancing type="adaptive" load-sample="5" n-replicas="2"/-->
      <load-balancing type="round-robin"/>
      <object identity="Processor" type="::omero::grid::Processor"/>
    </replica-group>

    <node name="master">
      <server-instance template="Glacier2Template"
        client-endpoints="tcp -h 127.0.0.1 -p 4063"
        session-timeout="300"
        server-endpoints="tcp -h 127.0.0.1"/>
      <server-instance template="BlitzTemplate" index="0"/>
      <server-instance template="ProcessorTemplate" index="0"/>
      <target name="postgres">
        <server-instance template="ShellTemplate" id="postgres"/>
      </target>
      <target name="jboss">
        <server-instance template="ShellTemplate" id="JBoss" exe="lib/jboss.py">
          <properties>
            <property name="jboss.home" value="jboss"/>
          </properties>
        </server-instance>
      </target>
    </node>

    <node name="node1">
      <server-instance template="ProcessorTemplate" index="1"/>
    </node>

    <node name="node2">
      <server-instance template="ProcessorTemplate" index="2"/>
    </node>

  </application>

</icegrid>
