*** Settings ***
Documentation     Tests submission of forms.

Resource          ../config.txt
Resource          ../../resources/web/login.txt
Resource          ../../resources/web/tree.txt

Suite Setup         Run Keywords  User "${USERNAME}" logs in with password "${PASSWORD}"  Maximize Browser Window
# Suite Teardown      Close all browsers

*** Test Cases ***

Test Delete Project
    [Documentation]     Tests form based on base_custom_dialog.html and script_ui.html

    Select Experimenter
    ${pid}=                                 Create project      robot test delete
    Click Element                           refreshButton
    Wait Until Page Contains Element        id=project-${pid}
    Click Element                           id=deleteButton
    Wait Until Page Contains Element        id=delete-dialog-form
    Click Element                           xpath=//button/span[contains(text(),'Yes')]
    # On POST success, Experimenter should be selected and project removed from tree
    Wait Until Page Contains Element        xpath=//li[@rel='experimenter']/a[contains(@class, 'jstree-clicked')]
    Page Should Not Contain Element         id=project-${pid}


Test Edit Project

    Select Experimenter
    ${pid}=                                 Create project      robot test edit
    Wait Until Page Contains Element        projectname-${pid}
    # Edit Name
    Click Element                           css=#projectname-${pid} button.btn_edit
    Wait Until Page Contains Element        form-projectname-${pid}
    # id 'id_name' is not unique!
    Input Text                              xpath=//form[@id='form-projectname-${pid}']//input[@id='id_name']  editedName
    Submit Form                             form-projectname-${pid}
    Wait Until Page Contains Element        xpath=//span[@id='projectname-${pid}-name'][contains(text(), 'editedName')]

    # Edit Description
    Click Element                           css=#projectdescription-${pid} button.btn_edit
    Wait Until Page Contains Element        form-projectdescription-${pid}
    Input Text                              xpath=//form[@id='form-projectdescription-${pid}']//textarea[@id='id_description']  newDesc
    Submit Form                             form-projectdescription-${pid}
    Wait Until Page Contains Element        xpath=//span[@id='projectdescription-${pid}-description'][contains(text(), 'newDesc')]

