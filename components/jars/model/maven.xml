<project 
   xmlns:ant="jelly:ant"
   xmlns:j="jelly:core" 
   xmlns:maven="jelly:maven" 
>
  
  <postGoal name="clean:clean">
    <ant:delete dir="${basedir}/src/java/org/ome/omero/model"/>
  </postGoal>

  <goal name="middlegen">
    <ant:uptodate property="middlegen.not.required" targetfile="${basedir}/src/java/org/ome/omero/model/" >
        <ant:srcfiles dir= "${basedir}/src/middlegen" includes="*.xml"/>
    </ant:uptodate>

    <ant:pathconvert targetos="${ant.os}" property="maven.classpath" refid="maven.dependency.classpath"/>

    <ant:ant
         antfile="${basedir}/src/middlegen/middlegen-build.xml"
         dir="${basedir}"
         target="gen-java"
         inheritAll="true"
         inheritRefs="false"
       />

  </goal>

  <preGoal name="java:compile">
    <attainGoal name="middlegen"/> 
  </preGoal>

</project>

