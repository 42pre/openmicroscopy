<?xml version="1.0" encoding="utf-8"?>
<project name="omero" default="usage" basedir="."  xmlns:ivy="antlib:org.apache.ivy.ant">
<!--
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#
# $Id$
# 
# Copyright 2006 University of Dundee. All rights reserved.
# Use is subject to license terms supplied in LICENSE.txt
# 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Written by:  Josh Moore <josh.moore@gmx.de>
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
  DOCUMENTATION:
  ==============================================================================
  This is the main build script for binary distributions and replaces the 
  main build script (OMERO_HOME/build.xml) in the OMERO_HOME/dist directories. 

  Several of these tasks are used by the components to prevent duplication.

-->

	<!-- ticket:800 - configuration is now stored in system preferences
        loading everything from there that we possibly can -->
        <mkdir dir="${basedir}/target"/>
	<java classname="prefs" fork="true" output="${basedir}/target/prefs.properties">
		<arg value="get"/>
        </java>
        <property file="${basedir}/target/prefs.properties"/>

        <!-- Reproducing dependencies.xml locally -->
        <target name="deps-configure"> <ivy:resolve file="${basedir}/omero.ivy" type="jar" conf="server"/> </target>
        <target name="deps-buildlist"> <ivy:buildlist> <fileset dir="${basedir}" includes="build.xml"/> </ivy:buildlist> </target>
        <target name="deps-retrieve"> <!-- noop --> </target>
        <target name="deps-publish-local"> <!-- noop --> </target>
        <path id="omero.classpath">
          <fileset dir="${basedir}/lib/repository" includes="**/*.jar"/>
        </path>

	<property name="import.dir" value="${basedir}/components/antlib/resources/"/>
	<property name="ivy.dep.file"  value="${basedir}/omero.ivy"/>
	<property name="ivy.buildlist.ivyfilepath" value="${basedir}/omero.ivy"/>
	<import file="${import.dir}/global.xml"/>
	<import file="${import.dir}/lifecycle.xml"/>

	<property file="${basedir}/etc/local.properties"/>
	<property file="${basedir}/etc/local.properties"/>
	<property file="${basedir}/etc/local.properties"/>

	<property file="${basedir}/etc/local.properties"/>
	<property file="${basedir}/etc/local.properties.example"/>
	<property file="${basedir}/etc/omero.properties"/>
	<property file="${basedir}/etc/hibernate.properties"/>

	<target name="usage"
		description="Usage information">
		<concat>
			<filelist dir="${import.dir}" files="usage-omero.txt"/>
		</concat>
	</target>

</project>

